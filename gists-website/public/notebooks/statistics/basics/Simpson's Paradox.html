<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=9737a412">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h1 id="Simpson's-Paradox">Simpson's Paradox<a class="anchor-link" href="#Simpson's-Paradox">¶</a></h1>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=66dd695d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Simpson's Paradox is a phenomenon in statistics where a trend that appears in several different groups of data reverses or disappears when the groups are combined. In other words, a pattern that holds within multiple subgroups can be misleading or even opposite when looking at the overall, aggregated data.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=8eb77d61">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In [1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Simpson's Paradox is a phenomenon in statistics where a trend that appears in several different groups of data disappears or reverses when these groups are combined. This paradox shows how aggregating data can sometimes lead to misleading conclusions.</span>

<span class="c1"># Let's illustrate Simpson's Paradox with a simple example using pandas:</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Example data: Two treatments (A and B) for a condition, split by gender</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'Gender'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Male'</span><span class="p">,</span> <span class="s1">'Male'</span><span class="p">,</span> <span class="s1">'Female'</span><span class="p">,</span> <span class="s1">'Female'</span><span class="p">],</span>
    <span class="s1">'Treatment'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'A'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">,</span> <span class="s1">'A'</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">],</span>
    <span class="s1">'Successes'</span><span class="p">:</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s1">'Trials'</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Calculate success rates within each gender</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'Success Rate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Successes'</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Trials'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Success rates by gender and treatment:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">'Gender'</span><span class="p">,</span> <span class="s1">'Treatment'</span><span class="p">,</span> <span class="s1">'Success Rate'</span><span class="p">]])</span>

<span class="c1"># Aggregate data by treatment (ignoring gender)</span>
<span class="n">agg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Treatment'</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">agg</span><span class="p">[</span><span class="s1">'Success Rate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">agg</span><span class="p">[</span><span class="s1">'Successes'</span><span class="p">]</span> <span class="o">/</span> <span class="n">agg</span><span class="p">[</span><span class="s1">'Trials'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Aggregated success rates by treatment (ignoring gender):"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">agg</span><span class="p">[[</span><span class="s1">'Success Rate'</span><span class="p">]])</span>

<span class="c1"># Notice that within each gender, Treatment B has a higher success rate,</span>
<span class="c1"># but when data is aggregated, Treatment A appears better.</span>
<span class="c1"># This is Simpson's Paradox in action!</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Success rates by gender and treatment:
   Gender Treatment  Success Rate
0    Male         A           0.4
1    Male         B           0.9
2  Female         A           0.1
3  Female         B           0.3

Aggregated success rates by treatment (ignoring gender):
           Success Rate
Treatment              
A                  0.25
B                  0.60
</pre>
</div>
</div>
</div>
</div>
</div>
</main>
</body>